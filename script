FFVideoSource("D:\BD\Chungking Express\video.mkv")
Crop(60, 0, -60, -0).FillBorders(1, 0, 1, 0)

# dirty lines
dl1 = FixRBr(0, 3.5).FixRBr(1079, 3.5).bbmod(cleft = 2, cright = 2, thresh = 128, blur = 999)

trim(0, 637) + trim(dl1, 638, 147706) + trim(147707, 0)

z_Spline36Resize(1798, 1080, 1, 0, -1, 0, dither="error_diffusion")

#z_Spline36Resize(1198, 720, 1, 0, -1, 0, dither="error_diffusion")

# deband/deblock
db1 = mt_merge(last, neo_f3kdb(dither_algo = 3, range = 31, grainY = 100, grainC = 100, Y = 80, Cb = 80, Cr = 80, dynamic_grain = true, keep_tv_range = true, sample_mode = 4), mt_binarize(32, true), luma = true)
db2 = mt_merge(last, neo_f3kdb(dither_algo = 3, range = 15, grainY = 100, grainC = 100, Y = 80, Cb = 80, Cr = 80, dynamic_grain = true, keep_tv_range = true, sample_mode = 4), mt_binarize(28, true), luma = true)
db3 = mt_merge(last, neo_f3kdb(dither_algo = 3, range = 15, grainY = 100, grainC = 100, Y = 80, Cb = 80, Cr = 80, dynamic_grain = true, keep_tv_range = true, sample_mode = 4), mt_binarize(36, true), luma = true)
db4 = mt_merge(last, neo_f3kdb(dither_algo = 3, range = 31, grainY = 100, grainC = 100, Y = 80, Cb = 80, Cr = 80, dynamic_grain = true, keep_tv_range = true, sample_mode = 4), mt_binarize(36, true), luma = true)

ConditionalFilter(db1, last, "ST", "=", "1")
ConditionalFilter(db2, last, "ST", "=", "2")
ConditionalFilter(db3, last, "ST", "=", "3")
ConditionalFilter(db4, last, "ST", "=", "4")

ConditionalReader("filter.txt", "ST", show = False)

#myFFInfo("Filtered")

/*type int
default 0

R 1067 1119 1
R 1271 1618 2
R 1746 2471 1
R 3421 3482 2
R 9283 10237 2
R 10566 10590 2
R 10787 10846 2
R 11059 11098 2
R 12516 12953 2
R 14693 14758 2
R 14888 15278 2
R 15279 15436 1
R 15463 15503 2
R 15527 16007 2
R 16040 16285 2
R 18280 18404 2
R 18854 19542 2
R 20234 20269 2
R 20633 20715 2
R 20959 21163 2
R 21227 21826 2
R 23799 23858 2
R 24026 24169 2
R 24468 24502 2
R 24612 26200 2
R 27501 27796 2
R 28326 29717 2
R 29855 30293 2
R 30595 30698 2
R 31098 31142 1
R 31344 31358 2
R 31716 33373 2
R 37569 38258 2
R 38639 39994 2
R 44750 45068 2
R 45069 45298 2
R 47917 48476 2
R 48574 48926 2
R 48977 49297 2
R 50802 51674 2
R 52192 52313 2
R 52510 52653 2
R 55023 55152 2
R 56334 56629 2
R 57918 58012 2
R 59592 59629 2
R 59945 60479 2
R 62629 62671 3
R 64037 64071 2
R 64387 64481 2
R 66154 66255 3
R 66381 66705 2
R 66760 67467 2
R 68212 69389 3
R 69390 69425 3
R 69532 69692 2
R 69703 69928 3
R 72182 72333 2
R 74329 74732 2
R 75929 75996 2
R 76133 76155 2
R 78478 78530 3
R 78621 78689 3
R 81416 81592 3
R 81724 81744 3
R 81882 82074 3
R 82307 82801 2
R 83498 83662 2
R 84039 84141 2
R 84297 84444 2
R 84936 85003 2
R 85191 85268 2
R 86546 87300 2
R 87593 88905 2
R 89890 90139 2
R 90786 91104 2
R 91105 91466 1
R 91493 92642 2
R 92710 93503 2
R 93530 93746 2
R 93754 93774 3
R 94146 94696 2
R 96909 97037 3
R 97358 97439 3
R 98053 98190 3
R 102165 102320 3
R 102962 103054 3
R 103225 103303 3
R 103382 103455 3
R 103614 103686 3
R 103788 103810 3
R 104332 104552 3
R 104644 104955 3
R 106603 107036 3
R 107037 107665 1
R 110131 110304 3
R 112110 112258 3
R 114172 114382 3
R 115147 115258 3
R 115846 116890 2
R 117080 117907 3
R 118000 119830 3
R 120092 120828 3
R 121676 121845 3
R 121846 122032 2
R 122204 122255 2
R 122354 122460 3
R 122500 122510 3
R 122860 122984 3
R 123164 123300 3
R 123434 123500 3
R 123595 125542 3
R 125584 125700 3
R 126039 126073 3
R 126164 126239 1
R 126240 126337 3
R 126548 126621 4
R 126622 126803 3
R 126804 127087 2
R 127245 127697 3
R 127730 128360 2
R 129124 129261 2
R 129455 131274 3
R 131275 131526 2
R 131882 132409 2
R 132661 132977 2
R 133221 133550 2
R 138486 138569 3
R 139641 139702 3
R 139821 139996 3
R 140269 140305 3
R 141034 141058 3
R 141367 141391 3
R 141637 141930 3
R 142205 142294 3
R 142802 143066 3
R 143100 143146 3
R 143510 143656 3
R 143725 143860 3
R 143914 143951 3
R 143952 144105 2*/
